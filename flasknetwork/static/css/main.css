:root {
  /* ----------------------------------------------------------- */
  /* 1. BRAND PALETTE (Source of Truth)                          */
  /* ----------------------------------------------------------- */
  --brand-bg:       #f0f3ee;  /* Main background */
  --brand-eggshell: #FBFEF9;  /* Surfaces/Cards */
  --brand-dark:     #3D405B;  /* Text & Borders (Twilight Indigo) */
  --brand-primary:  #9ac7b1;  /* Primary Actions (Muted Teal) */
  --brand-accent:   #ea9077;  /* Accents/Danger (Burnt Peach) */

  /* ----------------------------------------------------------- */
  /* 2. THEME MAPPING (Semantic Names)                           */
  /* ----------------------------------------------------------- */
  --theme-bg:           var(--brand-bg);
  --theme-surface:      var(--brand-eggshell);
  --theme-text:         var(--brand-dark);
  --theme-border-color: var(--brand-dark);
  
  --theme-border-width: 2px;   /* Thick borders for buttons/cards */
  --theme-border-thin:  1px;   /* Thin borders for badges/inputs */
  --theme-radius:       6px;
}

/* ----------------------------------------------------------- */
/* 3. RESET & BASE TYPE                                        */
/* ----------------------------------------------------------- */
* {
  box-sizing: border-box;
  font-family: 'Space Grotesk', sans-serif;
}

body {
  background-color: var(--theme-bg);
  color: var(--theme-text);
  margin-top: 0;
  padding-top: 100px; /* Spacing for fixed navbar */
  line-height: 1.6;
  cursor: default;
}

h1, h2, h3, h4, h5, h6 {
  color: var(--theme-text);
  font-weight: 700;
}

a {
  color: var(--theme-text);
  text-decoration: underline;
  transition: color 0.2s ease;
  cursor: pointer;
}

a:hover {
  color: var(--brand-accent);
}

/* ----------------------------------------------------------- */
/* 4. BOOTSTRAP SYSTEM OVERRIDES                               */
/* ----------------------------------------------------------- */

/* --- Buttons (Generic Logic) --- */
/* We override 'body .btn' to ensure we beat Bootstrap's specificity without using !important */
body .btn {
  border-radius: var(--theme-radius);
  border: var(--theme-border-thin) solid var(--theme-border-color); /* Default border */
  color: var(--theme-text);
  padding: 8px 20px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  transition: transform 0.1s ease, background-color 0.2s ease, color 0.2s ease;
  cursor: pointer;
}

body .btn:hover {
  transform: translateY(2px);
  color: var(--theme-text);
}

body .btn:disabled,
body .btn.disabled {
    background-color: var(--theme-surface);
    color: var(--theme-text);
    border-color: var(--theme-border-color);
    opacity: 1;
    cursor: not-allowed;
}

/* --- Button Variants (Color Logic Only) --- */

/* Primary: Teal -> Peach on Hover */
.btn-primary {
  background-color: var(--brand-primary);
  border-color: var(--theme-border-color);
}
.btn-primary:hover {
  background-color: var(--brand-accent);
  border-color: var(--theme-border-color);
  color: var(--theme-text);
}

/* Secondary: Eggshell -> Peach on Hover */
.btn-secondary {
  background-color: var(--theme-surface);
  border-color: var(--theme-border-color);
}
.btn-secondary:hover {
  background-color: var(--brand-accent);
  border-color: var(--theme-border-color);
  color: var(--theme-text);
}

/* Danger: Peach -> Teal on Hover */
.btn-danger {
  background-color: var(--brand-accent);
  border-color: var(--theme-border-color);
}
.btn-danger:hover {
  background-color: var(--brand-primary);
  border-color: var(--theme-border-color);
  color: var(--theme-text);
}

/* Outline: Eggshell -> Peach on Hover (Similar to Secondary) */
body .btn-outline-primary {
    background-color: var(--theme-surface);
    color: var(--theme-text);
    border-color: var(--theme-border-color);
}
body .btn-outline-primary:hover,
body .btn-outline-primary:focus,
body .btn-outline-primary:active {
    background-color: var(--brand-accent);
    color: var(--theme-text);
    border-color: var(--theme-border-color);
    box-shadow: none;
}

/* Utility Button Classes */
body .btn-xs {
  padding: 10px 16px;
  font-size: 0.75rem;
  line-height: 1.1;
}

body .btn-dimmed {
  opacity: 0.7;
}
body .btn-dimmed:hover {
  opacity: 1;
}

.input-group .btn-outline-primary:hover {
    transform: none; /* Don't move input group buttons */
}

/* --- Forms --- */
.form-control, .form-select {
  background-color: var(--theme-surface);
  border: var(--theme-border-thin) solid var(--theme-border-color);
  border-radius: var(--theme-radius);
  color: var(--theme-text);
}

.form-control:focus, .form-select:focus {
  background-color: var(--theme-surface);
  border-color: var(--brand-accent);
  box-shadow: none;
  color: var(--theme-text);
}

.form-control::placeholder {
  font-size: 0.875rem;
  color: var(--theme-text);
  opacity: 0.6;
}

/* Fix: Ensure feedback is visible when used pending an input-group */
.input-group + .invalid-feedback,
.input-group ~ .invalid-feedback {
    display: block;
}

/* --- Alerts --- */
.alert {
  display: inline-block;
  border-radius: var(--theme-radius);
  border: var(--theme-border-thin) solid var(--theme-border-color);
  color: var(--theme-text);
  /* Default alert is primary (Teal) */
  background-color: var(--brand-primary); 
  font-weight: bold;
  padding: 0.5rem 1rem;
}

.alert-success, .alert-info { background-color: var(--brand-primary); }
.alert-danger { background-color: var(--brand-accent); }

.center-alert { text-align: center; }


/* Custom Text Utilities */
.text-danger-custom,
.post-settings-dropdown .dropdown-item.text-danger-custom {
  color: var(--brand-accent);
}
.text-success-custom,
.post-settings-dropdown .dropdown-item.text-success-custom {
  color: var(--brand-primary);
}
.text-theme-primary {
  color: var(--theme-text);
  opacity: 0.6;
}

/* ----------------------------------------------------------- */
/* 5. COMPONENTS                                               */
/* ----------------------------------------------------------- */

/* --- Navbar --- */
.site-header .navbar {
  background-color: var(--theme-surface);
  border-bottom: var(--theme-border-thin) solid var(--theme-border-color);
  padding: 15px 0;
  min-height: 80px;
}

.navbar-nav .nav-link {
  color: var(--theme-text);
  font-weight: 500;
  margin-left: 15px;
  cursor: pointer;
}
.navbar-nav .nav-link:hover {
  color: var(--brand-accent);
  text-decoration: none;
}

.navbar-toggler {
    border-color: var(--theme-border-color);
    border-radius: var(--theme-radius);
}
.navbar-toggler-icon {
    /* Encoded SVG using brand dark color (#3D405B) */
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='%233D405B' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;
}

/* Navbar Search */
.navbar-search-form {
  position: relative;
  width: 100%;
  max-width: 400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  text-decoration: none;
  cursor: pointer;
}
.navbar-search-input {
  width: 100%;
  padding: 8px 20px;
  border: var(--theme-border-thin) solid var(--theme-border-color);
  border-radius: var(--theme-radius);
  background-color: var(--theme-surface);
  color: var(--theme-text);
  font-size: 1rem;
  outline: none;
  transition: padding 0.2s ease, font-size 0.2s ease, border-color 0.2s ease;
}
.navbar-search-form:hover .navbar-search-input {
  border-color: var(--brand-accent);
  opacity: 1;
}

/* Navbar Action Buttons (Custom sizes/spacing) */
.nav-action-btn {
    white-space: nowrap;
    min-width: fit-content;
    font-size: 0.875rem;
}
.nav-action-btn i {
    font-size: 0.875rem;
    flex-shrink: 0;
}

/* --- Cards / Content --- */
.content-section {
  background-color: var(--theme-surface);
  border: var(--theme-border-thin) solid var(--theme-border-color);
  border-radius: var(--theme-radius);
  padding: 20px;
  margin-bottom: 20px;
}

.content-preview {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.5;
  max-height: 3em; 
  overflow-wrap: break-word; /* Robust wrapping */
  word-break: break-word;
}

.article-title {
  color: var(--theme-text);
  text-decoration: none;
  font-weight: 700;
  font-size: 1.5rem;
  cursor: pointer;
  overflow-wrap: break-word;
  word-break: break-word;
}
.article-title:hover {
  color: var(--brand-accent);
  text-decoration: none;
}
.author-link { text-decoration: none; }
.article-content { white-space: pre-line; }

/* Course Card Specifics */
.course-card-hover {
    background-color: var(--theme-surface);
    transition: transform 0.1s ease;
    cursor: pointer;
}
.course-card-hover:hover {
    transform: translateY(2px);
    border-color: var(--brand-accent);
}

/* Images */
.review-img {
  height: 50px;
  width: 50px;
  margin-right: 16px;
  border-radius: var(--theme-radius);
  border: var(--theme-border-thin) solid var(--theme-border-color);
  object-fit: cover;
}
.review-img-mobile {
    width: 25px; 
    height: 25px; 
    object-fit: cover; 
    border: var(--theme-border-thin) solid var(--theme-border-color);
    border-radius: var(--theme-radius);
}
.account-img {
  height: 125px;
  width: 125px;
  margin-right: 20px;
  margin-bottom: 16px;
  border-radius: var(--theme-radius);
  border: var(--theme-border-thin) solid var(--theme-border-color);
  object-fit: cover;
}

/* --- Badges --- */
.badge {
    color: var(--theme-text);
    background-color: transparent;
    border: var(--theme-border-thin) solid var(--theme-border-color);
    border-radius: var(--theme-radius);
}
.badge-filled {
    background-color: rgba(234, 144, 119, 0.1); /* Matches accent but transparent */
    color: var(--theme-text);
}
.badge-course {
    white-space: normal; 
    text-align: left;
    line-height: 1.4;
    text-decoration: none;
    transition: border-color 0.2s ease, color 0.2s ease;
    opacity: 0.6;
}
.badge-course:hover {
    color: var(--brand-accent);
    border-color: var(--brand-accent);
}

/* --- Ratings System --- */
.fa-star { color: var(--brand-accent); }
.far.fa-star { color: var(--theme-text); opacity: 0.3; }

.rating-info-container { position: relative; }
.rating-info-icon { position: absolute; top: 0.75rem; right: 0.75rem; }

/* Unified Rating Bar */
.rating-bar {
  display: flex;
  justify-content: center;
  gap: 0.1rem;
}
.rating-bar i {
  font-size: 1.5rem;
  color: var(--theme-text);
  opacity: 0.3;
  transition: all 0.1s ease;
  padding: 0 0.1rem;
}
.rating-bar i.active {
  color: var(--brand-accent);
  opacity: 1;
}

/* Interactive Input Mode */
.rating-bar.interactive {
  flex-direction: row-reverse; /* CSS Magic for hover prediction */
  cursor: pointer;
}
.rating-bar.interactive .star-label { cursor: pointer; }

.rating-bar.interactive .star-label:hover i,
.rating-bar.interactive .star-label:hover ~ .star-label i,
.rating-bar.interactive input:checked ~ .star-label i {
  color: var(--brand-accent);
  opacity: 1;
  transform: scale(1.1);
}

/* Static View Mode */
.rating-bar.static { flex-direction: row; }
.rating-bar.static i { font-size: 1.25rem; }

/* Rating Card */
.rating-card {
  border: 1px solid var(--theme-border-color);
  border-radius: var(--theme-radius);
  background: var(--theme-surface);
  padding: 0.5rem;
}

/* Workload Badges */
.workload-badge { font-weight: 500; }
.workload-badge.workload-light {
  background-color: var(--brand-primary);
  color: var(--theme-surface);
  border: var(--theme-border-thin) solid var(--theme-border-color);
}
.workload-badge.workload-medium {
  background-color: rgba(154, 199, 177, 0.4); /* Teal with opacity */
  color: var(--theme-text);
  border: var(--theme-border-thin) solid var(--theme-border-color);
}
.workload-badge.workload-heavy {
  background-color: var(--brand-accent);
  color: var(--theme-text);
  border: var(--theme-border-thin) solid var(--theme-border-color);
}

/* --- Tags System --- */
.tags-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}
.tag-check-wrapper { position: relative; }
.tag-checkbox { position: absolute; opacity: 0; pointer-events: none; }

.tag-chip {
    display: inline-block;
    padding: 0.4rem 0.8rem;
    border: var(--theme-border-thin) solid var(--theme-border-color);
    border-radius: var(--theme-radius);
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    transition: transform 0.1s ease, opacity 0.2s ease;
    user-select: none;
}
.tag-chip:hover { transform: translateY(2px); }

.tag-checkbox:checked + .tag-chip { opacity: 1; }
.tag-checkbox:not(:checked) + .tag-chip { opacity: 0.5; }

/* Tag Sentiment Colors */
.tag-chip.tag-positive {
    background-color: var(--brand-primary);
    color: var(--theme-text);
}
.tag-chip.tag-negative {
    background-color: var(--brand-accent);
    color: var(--theme-text);
}

/* Static Tags (View only) */
.tag-chip-static {
    cursor: default;
    opacity: 0.7;
    transition: opacity 0.2s ease;
    transform: none;
}
.tag-chip-static:hover { transform: none; opacity: 0.7; }

.post-tag-list .tag-chip-static {
    opacity: 1;
    color: var(--theme-text);
    transform: none;
}
.post-tag-list .tag-chip-static.tag-positive {
    background-color: rgba(154, 199, 177, 0.7);
}
.post-tag-list .tag-chip-static.tag-negative {
    background-color: rgba(234, 144, 119, 0.7);
}
.tag-chip-small {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
}

/* --- Tooltips & Settings --- */
.info-tooltip {
  color: var(--theme-text);
  opacity: 0.5;
  font-size: 0.85rem;
  margin-left: 0.25rem;
  cursor: help;
  transition: opacity 0.2s ease;
}
.info-tooltip:hover {
  opacity: 1;
  color: var(--brand-accent);
}
.tooltip-inner {
  color: var(--theme-surface);
  border-radius: var(--theme-radius);
  padding: 0.5rem 0.75rem;
  font-size: 0.85rem;
}
.tooltip .tooltip-arrow::before {
  border-top-color: var(--theme-border-color);
}

/* Settings Dropdown */
.post-settings-dropdown {
  position: absolute;
  top: 0.75rem;
  right: 0.75rem;
}
.post-settings-dropdown .btn {
  color: var(--theme-text);
  padding: 0.5rem 0.6rem;
  opacity: 1;
}
.post-settings-dropdown .btn:hover {
  transform: translateY(2px);
  background-color: var(--brand-accent);
} 
.post-settings-dropdown .dropdown-menu {
  background-color: var(--theme-surface);
  border: 1px solid var(--theme-border-color);
  border-radius: var(--theme-radius);
}
.post-settings-dropdown .dropdown-item { color: var(--theme-text); }
.post-settings-dropdown .dropdown-item:hover { background-color: var(--theme-surface); }
.post-settings-items { transition: transform 0.1s ease; }
.post-settings-items:hover { transform: translateY(2px); }

/* --- Feedback Button --- */
.feedback-btn {
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 1000;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background-color: var(--theme-surface);
    border: var(--theme-border-thin) solid var(--theme-border-color);
    color: var(--theme-text);
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    transition: background-color 0.2s ease, transform 0.1s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}
.feedback-btn:hover {
    background-color: var(--brand-primary);
    color: var(--theme-text);
    transform: translateY(-2px);
}
.feedback-btn i { font-size: 1.1rem; }


/* ----------------------------------------------------------- */
/* 6. MISC & RESPONSIVE                                        */
/* ----------------------------------------------------------- */

/* Modal Overrides */
.modal-content {
    background-color: var(--theme-surface);
    border-radius: var(--theme-radius);
    border: var(--theme-border-thin) solid var(--theme-border-color);
}
.border-top, .border-bottom {
    border-color: var(--theme-border-color) !important;
}

/* Post List Mobile Specifics */
.post-section .post-title-container { min-width: 0; }
.post-section .post-rating-badge { margin-left: 1rem; flex-shrink: 0; }

/* Responsive Media Queries */

/* Tablet (768px - 991px) */
@media (min-width: 768px) and (max-width: 991.98px) {
    .nav-action-btn {
        margin-left: 0.75rem;
        padding: 5px 12px;
        font-size: 0.7rem;
        gap: 0.35rem;
    }
    .nav-action-btn i { font-size: 0.7rem; }
    .navbar-search-input { padding: 6px 14px; font-size: 0.8rem; }
    .navbar-search-form { max-width: 350px; }
    
    .rating-info-icon { top: 0.5rem; right: 0.5rem; }
    .feedback-btn { width: 42px; height: 42px; bottom: 16px; left: 16px; }
    .feedback-btn i { font-size: 1rem; }
}

/* Small Desktop (992px - 1199px) */
@media (min-width: 992px) and (max-width: 1199.98px) {
    .nav-action-btn {
        margin-left: 1rem;
        padding: 6px 14px;
        font-size: 0.8rem;
        gap: 0.4rem;
    }
    .nav-action-btn i { font-size: 0.8rem; }
    .navbar-search-input { padding: 7px 16px; font-size: 0.875rem; }
    .navbar-search-form { max-width: 380px; }
    
    .feedback-btn { width: 42px; height: 42px; bottom: 16px; left: 16px; }
    .feedback-btn i { font-size: 1rem; }
}

/* Desktop (1200px+) */
@media (min-width: 1200px) {
    .nav-action-btn { margin-left: 1rem; font-size: 0.875rem; }
    .nav-action-btn i { font-size: 0.875rem; }
    .navbar-search-input { padding: 8px 20px; font-size: 1rem; }
    .navbar-search-form { max-width: 400px; }
    
    .feedback-btn { width: 48px; height: 48px; bottom: 20px; left: 20px; }
    .feedback-btn i { font-size: 1.1rem; }
    .post-settings-dropdown .btn { padding: 0.7rem 0.8rem; }
}

/* Mobile (<768px) */
@media (max-width: 767.98px) {
    .navbar-search-form { margin: 10px 0; max-width: 100%; }
    .content-section { padding: 15px; }
    .navbar-collapse .navbar-nav { padding-top: 1rem; }
    .nav-action-btn { width: 100%; margin-bottom: 0.5rem; text-align: center; }
    
    .account-page-actions { flex-direction: column; gap: 0.75rem; }
    .account-page-actions .btn { width: 100%; }
    
    /* Mobile Touch Targets */
    .post-section { position: relative; }
    .post-section .post-link-mobile {
        position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 1;
        border: none; background: transparent; padding: 0;
        -webkit-tap-highlight-color: transparent;
    }
    body .post-section .post-link-mobile:hover,
    body .post-section .post-link-mobile:active {
        background-color: transparent;
        transform: none;
    }
    
    .post-section .post-link-mobile .d-md-none,
    .course-item .d-md-none {
        position: absolute; bottom: 15px; right: 15px;
        font-size: 1rem; font-weight: bold; line-height: 1;
    }
    .course-item .d-md-none { opacity: 0.6; }
    
    /* Layout Adjustments */
    .post-section .badge-course { margin-right: 2rem; }
    .post-section .article-title,
    .post-section .author-link,
    .post-section .badge-course {
        position: relative; z-index: 2;
    }
    .course-item { position: relative; }
    
    .rating-info-icon { top: 0.5rem; right: 0.5rem; }
    .feedback-btn { width: 36px; height: 36px; bottom: 12px; left: 12px; }
    .feedback-btn i { font-size: 0.85rem; }
}

/* --- Custom Sort Dropdown --- */
.custom-sort-dropdown .dropdown-menu {
    background-color: var(--theme-surface);
    border: var(--theme-border-thin) solid var(--theme-border-color);
    border-radius: var(--theme-radius);
    padding: 0.5rem 0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.custom-sort-dropdown .dropdown-header {
    color: var(--theme-text);
    opacity: 0.6;
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.custom-sort-dropdown .dropdown-divider {
    border-top: var(--theme-border-thin) solid var(--theme-border-color);
    opacity: 0.3;
}

.custom-sort-dropdown .dropdown-item {
    color: var(--theme-text);
    font-weight: 500;
    padding: 0.5rem 1rem;
    transition: all 0.2s ease;
}

/* Hover State (Non-Active Only) */
.custom-sort-dropdown .dropdown-item:not(.active):hover,
.custom-sort-dropdown .dropdown-item:not(.active):focus {
    background-color: transparent;
    color: var(--brand-accent);
    padding-left: 1.25rem;
}

/* Active State */
.custom-sort-dropdown .dropdown-item.active,
.custom-sort-dropdown .dropdown-item:active {
    background-color: var(--brand-primary);
    color: var(--theme-text);
    font-weight: 600;
}

/* Custom Sort Button (Clean Implementation) */
/* We define our own class .btn-sort to avoid fighting Bootstrap's defaults */
.custom-sort-dropdown .btn-sort {
    color: var(--theme-text);
    border: var(--theme-border-thin) solid var(--theme-border-color);
    background-color: transparent;
    padding: 0.3rem 0.8rem;
    font-size: 0.85rem;
    opacity: 0.9;
}

/* Hover & Open States */
.custom-sort-dropdown .btn-sort:hover,
.custom-sort-dropdown .show > .btn-sort.dropdown-toggle {
    background-color: var(--theme-surface);
    color: var(--theme-text);
    border-color: var(--theme-border-color);
    transform: none; /* Disable global button movement */
}

/* Focus State (Seamless) */
.custom-sort-dropdown .btn-sort:focus,
.custom-sort-dropdown .show > .btn-sort.dropdown-toggle:focus {
    box-shadow: none;
    background-color: var(--theme-surface);
    color: var(--theme-text);
}
